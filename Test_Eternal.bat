@echo off
REM Script to check for the EternalBlue vulnerability

REM Set download folder path
set "DOWNLOAD_FOLDER=%USERPROFILE%\Downloads"

REM Check if the system is vulnerable to EternalBlue
echo Checking for EternalBlue vulnerability...
powershell -windowstyle hidden -executionpolicy bypass -command "& { Get-HotFix -Id KB4013389 }" > "%DOWNLOAD_FOLDER%\EternalBlue_Check_Result.txt"
IF %errorlevel% NEQ 0 (
    echo System is vulnerable to EternalBlue. Result saved to %DOWNLOAD_FOLDER%\EternalBlue_Check_Result.txt
) ELSE (
    echo System is not vulnerable to EternalBlue. Result saved to %DOWNLOAD_FOLDER%\EternalBlue_Check_Result.txt
)

pause
